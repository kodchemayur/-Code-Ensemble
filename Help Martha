#include <bits/stdc++.h>
using namespace std;
#define bitcount(x) __builtin_popcount(x)
#define ll long long int
#define INF 1000000007
#define PI 3.1415926535897932384626
#define endl "\n"
#define all(v) (v).begin(),(v).end()
#define mems(x, y) memset(x, y, sizeof(x))
const int mxN=5e4;
typedef pair<int, int>pii;
typedef pair<ll, ll>pl;
typedef vector<int>vi;
typedef vector<ll>vl;
typedef vector<pii>	vpii;
typedef vector<pl>vpl;
typedef vector<vi>vvi;
typedef vector<vl>vvl;
int main()
{
    ios_base::sync_with_stdio(false);
   	cin.tie(NULL);
   	cout.tie(0);
   	long long int t;
   	cin>>t;
   	while(t--)
    {
       string s;
       int x,y,n;
       cin>>s;
       cin>>x>>y>>n;
       int l=s.size();
       int a[4]={};
       for(int i=0;i<l;i++)
       {
           if(s[i]=='R')
           {
               a[0]++;
           }
           if(s[i]=='L')
           {
               a[1]++;
           }
           if(s[i]=='U')
           {
               a[2]++;
           }
           if(s[i]=='D')
           {
               a[3]++;
           }
       }
       while(n--)
       {
           int b[4]={};
           int x1,y1;
           cin>>x1>>y1;
           int sum1=x1-x,sum2=y1-y,s=0;
           if(sum1>0)
           {
               b[0]=sum1;
               s=s+sum1;
           }
           else 
           {
               sum1=(-1)*sum1;
               b[1]=sum1;
               s=s+sum1;
           }
           if(sum2>0)
           {
               b[2]=sum2;
               s=s+sum2;
           }
           else 
           {
               sum2=(-1)*sum2;
               b[3]=sum2;
               s=s+sum2;
           }
           int flag=0;
           for(int i=0;i<4;i++)
           {
               if(a[i]<b[i])
               {
                   cout<<"NO"<<endl;
                   flag=1;
                   break;
               }
           }
           if(flag==0)
           {
                cout<<"YES "<<s<<endl;
           }
       }
    }
   	return 0;
}
